<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard | Meerko</title>

    <link rel="icon" href="/favicon.png">

    <!-- Bootstrap CSS for styling and responsiveness -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <!-- Swiper CSS for carousels -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>
    <!-- Custom stylesheet -->
    <link rel="stylesheet" href="/style.css"/>

    <!-- jQuery (slim version) for certain functionalities -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <!-- Swiper JS for interactive carousels -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <!-- Vanilla LazyLoad for lazy loading images -->
    <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js"></script>
</head>
<body>

    <!-- Alert Container -->
    <!-- This div serves as a container for displaying toast notifications or alerts to the user. -->
    <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1055;"></div>

    <!-- Navigation -->
    <!-- The main navigation bar, providing links to other parts of the application, theme toggle, and logout functionality. -->
    <nav class="navbar px-5" style="background-color: var(--highlight-blue); color: #ffffff;">
        <div class="container-fluid">
            <div class="row w-100 align-items-center">
                <!-- Left: Logo -->
                <div class="col-md-3 d-flex align-items-center justify-content-start gap-3">
                    <h1 class="mb-0 d-flex align-items-center">
                        <a href="/" style="text-decoration: none; color: inherit; display: flex; align-items: center;">
                            Meerk
                            <img src="/favicon.png" alt="OWO" style="width: 32px; height: 32px; margin-top: 12px;">
                        </a>
                    </h1>

                    <button id="theme-toggle" class="btn btn-sm" title="Theme Toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-brilliance" viewBox="0 0 16 16">
                            <path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M1 8a7 7 0 0 0 7 7 3.5 3.5 0 1 0 0-7 3.5 3.5 0 1 1 0-7 7 7 0 0 0-7 7"/>
                        </svg>
                    </button>
                </div>

                <!-- Center: Page Title or Placeholder (if needed) -->
                <div class="col-md-6 text-center">
                    <!-- Optional: dashboard title or leave empty -->
                    <h6 class="mb-0">“Thoughts have to be put into words for them to get across.”<br>- Frieren (Frieren: Beyond Journey’s End)</h6>
                </div>

                <!-- Right: Navigation Links -->
                <div class="col-md-3 d-flex justify-content-end align-items-center">
                    <ul class="d-flex mb-0 align-items-center" style="gap: 25px; list-style: none;">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        <li>
                            <form action="/auth/logout" method="POST" onsubmit="return confirm('Are you sure you want to log out?');" class="display-inline">
                                <button type="submit" class="btn btn-danger btn-sm logout-btn">Logout</button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <main>
        <!-- Spotlight Section -->
        <!-- This section displays a personalized anime spotlight for the logged-in user,
        including recommendations and quick access to watchlist management. -->
        <section class="my-5">
        <div class="container spotlight-wrapper">
            <div class="dashboard-spotlight-banner">
            <div id="anime-spotlight-container" class="row"></div>
            <img src="/nanashi-mumei-loading.gif" alt="Anime Spotlight Image" class="dashboard-spotlight-img" loading="eager">
            <div class="spotlight-content">
                <h6 class="text-warning">YOUR DAILY SPOTLIGHT</h6>
                <h2>Welcome back, {{display_name}}!</h2>
                <p class="header-space-below">Here’s some animes that you might like.</p>
                <!-- Recommended Animes will be injected here and replace labels -->
                <h4 class="one-liner">Anime Title</h4>
                <h6>Type | Episodes</h6>
                <h6 class="tags">Rating | Tags</h6>
                <p class="dashboard-description">Anime Description</p>
                <div class="row">
                    <div class="col-6">
                        <button class="btn btn-watch btn-lg me-2 w-100" id="add-to-watchlist-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-square-fill align-middle mb-1" viewBox="0 0 16 16">
                            <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm5.5 10a.5.5 0 0 0 .832.374l4.5-4a.5.5 0 0 0 0-.748l-4.5-4A.5.5 0 0 0 5.5 4z"/>
                        </svg> Add to Watchlist</button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-watch btn-lg me-2 w-100" id="next-spotlight-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-fill mb-1" viewBox="0 0 16 16">
                            <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
                        </svg> Next</button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <button class="btn btn-detail btn-lg mb-1 w-100" id="myListBtn"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="30" fill="currentColor" class="bi bi-card-list mb-1" viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"/>
                            <path d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8m0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0"/>
                        </svg> My Watchlist</button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-watch btn-lg mb-1 w-100" id="myCompletedAnimesBtn"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="30" fill="currentColor" class="bi bi-card-checklist mb-1" viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"/>
                            <path d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0M7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0"/>
                        </svg> Completed Animes</button>
                    </div>
                </div>
            </div>
            </div>
        </div>
        </section>

        <!-- Watchlist -->
        <!-- Container for displaying the user's active watchlist (watching, plan to watch).
        Content is dynamically loaded and managed by JavaScript. -->
        <div id="watchlist-container" class="container fade-transition my-5"></div>

        <!-- Completed Watchlist -->
        <!-- Container for displaying the user's completed anime watchlist.
        Content is dynamically loaded and managed by JavaScript. -->
        <div id="completed-container" class="container fade-transition my-5"></div>

        <div>
            
        </div>

        <!-- Most Watchlist Section -->
        <!-- Displays a carousel of the most popular animes across all users,
        allowing discovery of trending series. -->
        <section class="mostwatchlist-section">
            <h2><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmark-heart mb-2" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 4.41c1.387-1.425 4.854 1.07 0 4.277C3.146 5.48 6.613 2.986 8 4.412z"/>
                <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z"/>
            </svg> Most Watchlisted Animes</h2>
            <div id="mostWatchlistCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner" id="mostWatchlistCarouselInner">
                    <!-- Most Watchlisted Animes will be injected here -->
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#mostWatchlistCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                 <button class="carousel-control-next" type="button" data-bs-target="#mostWatchlistCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </section>

        <!-- New and Upcoming Releases Carousel -->
        <!-- This section features carousels for both newly released and upcoming anime series,
        allowing users to stay updated with recent and future titles. -->
        <section class="new-and-upcoming-releases-section container-fluid my-3">
        <div class="row">
            <div class="col border-end pe-10">
                <!-- New Releases Carousel -->
                <div class="new-releases-section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmark-fill mb-2" viewBox="0 0 16 16">
                            <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2"/>
                        </svg> New Animes</h2>
                    <div class="d-flex gap-2">
                    <button class="carousel-nav-btn" type="button" data-bs-target="#newAnimesCarousel" data-bs-slide="prev">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left align-middle mb-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
                        </svg>
                    </button>
                    <button class="carousel-nav-btn" type="button" data-bs-target="#newAnimesCarousel" data-bs-slide="next">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right align-middle mb-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
                        </svg>
                    </button>
                    </div>
                    </div>
                    <div id="newAnimesCarousel" class="carousel slide" data-bs-ride="false">
                        <div class="new-carousel-inner">
                        <!-- New Releases will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <!-- Upcoming Releases Carousel -->
                <div class="upcoming-releases-section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmark-fill mb-2" viewBox="0 0 16 16">
                            <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2"/>
                        </svg> Upcoming Animes</h2>
                        <div class="d-flex gap-2">
                        <button class="carousel-nav-btn" type="button" data-bs-target="#upcomingAnimesCarousel" data-bs-slide="prev">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left align-middle mb-1" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
                            </svg>
                        </button>
                        <button class="carousel-nav-btn" type="button" data-bs-target="#upcomingAnimesCarousel" data-bs-slide="next">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right align-middle mb-1" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
                            </svg>
                        </button>
                        </div>
                    </div>
                    <div id="upcomingAnimesCarousel" class="carousel slide" data-bs-ride="false">
                        <div class="upcoming-carousel-inner">
                        <!-- Upcoming Releases will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </section>

        <!-- Featured Section -->
        <!-- Presents a curated selection of featured animes in an interactive carousel format,
        often based on high ratings or editorial picks. -->
        <section class="featured-section">
            <h2><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmark-heart mb-2" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 4.41c1.387-1.425 4.854 1.07 0 4.277C3.146 5.48 6.613 2.986 8 4.412z"/>
                <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z"/>
            </svg> Featured Animes</h2>
            <div class="deslide-wrap">
                <div id="slider" class="swiper-container">
                    <div class="swiper-wrapper">
                        <!-- Featured Animes will be injected here -->
                    </div>
                    <div class="swiper-pagination"></div>
                    <div class="swiper-nav-buttons">
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-button-next"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Random Section -->
        <!-- Allows users to discover new animes by displaying a random selection,
        with a button to fetch a new set of random animes. -->
        <section class="random-section">
        <div class="header-with-button mb-3">
            <h2 class="header-title"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmark-plus-fill mb-2" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M2 15.5V2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5m6.5-11a.5.5 0 0 0-1 0V6H6a.5.5 0 0 0 0 1h1.5v1.5a.5.5 0 0 0 1 0V7H10a.5.5 0 0 0 0-1H8.5z"/>
            </svg> Discover Something New</h2>
            <button id="randomizeBtn" class="btn btn-primary"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shuffle align-middle mb-1" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"/>
            <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"/>
            </svg></button>
        </div>
        <div class="anime-grid" id="random-animes">
            <!-- Random Animes will be Injected Here -->
        </div>
        </section>
    </main>

    <!-- Main client-side JavaScript for fetching and rendering anime data, and managing user interactions. -->
    <script src="/animefetcher.js"></script>
    <!-- Bootstrap JavaScript bundle for components like carousels, modals, and tooltips. -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Script to temporarily disable watchlist buttons after a click to prevent multiple rapid submissions. -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const buttonSelectors = [
                "#myListBtn",
                "#myCompletedAnimesBtn"
            ];

            buttonSelectors.forEach(selector => {
                const btn = document.querySelector(selector);
                if (btn) {
                    btn.addEventListener("click", () => {
                        btn.disabled = true;

                        setTimeout(() => {
                            btn.disabled = false;
                        }, 500);
                    });
                }
            });
        });
    </script>
    <!-- Script to add a 'sticky' class to the navbar when the user scrolls down, for visual effect. -->
    <script>
        const navbar = document.querySelector('.navbar');

        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('sticky');
            } else {
                navbar.classList.remove('sticky');
            }
        });
    </script>
    <!-- Initializes the Vanilla LazyLoad library for images with the 'lazy' class,
    improving page load performance by loading images only when they enter the viewport. -->
    <script>
        const lazyLoadInstance = new LazyLoad({
            elements_selector: ".lazy"
            // You can add more options here
        });
    </script>
    <!-- Script to attach an event listener to the "randomizeBtn" to fetch and display random animes. -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

        document.getElementById('randomizeBtn').addEventListener('click', fetchRandomAnimes);
        });
    </script>
    <!-- Script to toggle between light and dark themes, saving the preference to local storage. -->
    <script>
        const toggleBtn = document.getElementById('theme-toggle');
        toggleBtn.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark-theme') ? 'dark' : 'light');
        });
        
        // Load saved theme
        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark-theme');
        }
    </script>
    <footer>
        <!-- Footer section displaying copyright information. -->
        <p>&copy; 2025 Meerko. All rights reserved. Made by Mirko for a final project.</p>
    </footer>
</body>
</html>
